## 什么是中断？

**CPU 停下当前的工作任务，去处理其他事情，处理完后回来继续执行刚才的任务**，这一过程便是中断。

中断分为外部中断和内部中断：
### 外部中断
外部中断分为可屏蔽中断和不可屏蔽中断：
- **可屏蔽中断**：**通过 INTR 线向 CPU 请求的中断**，主要来自外部设备如硬盘、打印机、网卡等。此类中断并不会影响系统运行，可随时处理，甚至不处理，所以名为可屏蔽。
- **不可屏蔽中断**：**通过 NMI 线向 CPU 请求的中断**，如电源掉电、硬件线路故障等。这里不可屏蔽的意思不是不可以屏蔽，不建议屏蔽，而是问题太大，屏蔽不了，不能屏蔽的意思。注：INTR 和 NMI 都是 CPU 的引脚。

### 内部中断
内部中断分为 **陷阱**、**故障**、**终止**：
- **陷阱**：
  - **是一种有意的，预先安排的异常事件**，一般是在编写程序时故意设下的陷阱指令，而后执行到陷阱指令后，CPU 将会调用特定程序进行相关的处理，**处理结束后返回到陷阱指令的下一条指令**。
  - 例如 **系统调用**，程序调试功能等。`printf` 函数，最底层的实现中会有一条 **int 0x80 指令**，这就是一条陷阱指令，使用 **0x80 号中断**进行系统调用。

- **故障**：
  - 故障是在**引起故障的指令被执行，但没有执行结束时，CPU 检测到的一类意外事件**。
  - **出现故障时交由故障处理程序处理，如果能处理这个错误，就将控制返回到引起故障的指令，即 CPU 重新执行该指令。如果不能处理则报错**。
  - 常见的故障如 **缺页**，当 CPU 引用的虚拟地址对应的物理页不存在时就会发生缺页。缺页异常是能够修正的，有着**1**的缺页处理程序，它会将缺失的物理页从磁盘中重新调入主存。**而后再次执行引发缺页的指令**，使程序能够顺利执行。

- **终止**：
  - **执行指令的过程中发生了致命错误，不能修复，程序无法继续运行，只能终止**，通常会是一些硬件的错误。
  - **终止处理程序不会将控制返回到原程序，而是直接终止原程序**。


---


## 中断的作用是什么？

中断使得计算机系统具备**应对和处理突发事件的能力**，提高了 **CPU 的工作效率**。如果没有中断系统，CPU 就只能按照原来的程序编写的**先后顺序**，对各个外设进行查询和处理，即**轮询工作方式**。

轮询方法貌似公平，但**实际工作效率却很低**，**无法及时响应紧急事件**。

